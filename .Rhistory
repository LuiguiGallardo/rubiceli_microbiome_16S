base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 4,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/family_initial-feces.svg",
width = 6,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L5_v2.txt",
header = TRUE)
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("family")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 4,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/family_initial-feces.svg",
width = 7,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE)
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE)
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE)
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE)
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE)
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE)
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE,
sep='\t')
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("genera")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 4,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/genera_initial-feces.svg",
width = 7,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("genera")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 5,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/genera_initial-feces.svg",
width = 8,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L6_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("genera")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 5,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/genera_initial-feces.svg",
width = 8,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L7_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("specie")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 5,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/specie_initial-feces.svg",
width = 8,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L7_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("specie")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 5,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/specie_initial-feces.svg",
width = 9,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L7_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("specie")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 6,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/specie_initial-feces.svg",
width = 9,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L7_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("specie")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 6,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/specie_initial-feces.svg",
width = 11,
height = 4)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L7_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("specie")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 6,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/specie_initial-feces.svg",
width = 11,
height = 5)
dev.off()
# Input table
table <- read.table(file = "01_taxonomy/01_tax_sample/formatted_table_L7_v2.txt",
header = TRUE,
sep='\t')
# Reshape table
melted_table <- melt(table, id.vars = c("SampleID", "Description"))
# Rename headers
melted_table <- melted_table %>%
rename(sample = SampleID,
group = Description,
taxa = variable)
# Filter only taxa
filt_table <- melted_table %>% filter(!grepl("Grupo_Experimental|Dieta|Ambiente|Tiempo",
taxa))
filt_table$value <- as.numeric(as.character(filt_table$value))
# Filter only "Initial" samples
filt_table <- filt_table %>% filter(grepl("Inicial", group))
# Change name of group
filt_table$group <- recode_factor(filt_table$group, Inicial = "Initial feces")
# Colors
colourCount = length(unique(filt_table$taxa))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set3"))
# Plot
barplot_tax <- ggplot(filt_table, aes(x = sample,
y = value,
fill = taxa)) +
geom_bar(position="fill", stat="identity") +
facet_grid(~group,
scales = "free") +
labs(x = "",
y = "Relative abundance",
fill = toupper("specie")) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1),
expand = c(0, 0)) +
scale_fill_manual(values = getPalette(colourCount)) +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_text(hjust = 1),
legend.key.height = unit(1, "line"),
legend.key.width = unit(1, "line")) +
guides(fill = guide_legend(ncol = 6,
byrow = TRUE))
# Creation of .svg
ggsave("01_taxonomy/01_tax_sample/specie_initial-feces.svg",
width = 12,
height = 5)
dev.off()
