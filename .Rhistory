y = Observed.OTUs)) +
geom_boxplot(aes(color = group),
outlier.shape = NA) +
geom_point(aes(color = group),
size = 2,
shape = 21,
position = position_jitterdodge()) +
theme_test(base_size = 8,
base_family = "Arial") +
labs(x = "",
y = "Observed OTUs") +
scale_color_manual(values = colors) +
stat_compare_means(comparisons = p_value,
method = "wilcox.test") +
theme(legend.position = "none")
# Creation of .svg
ggsave("02_alpha_diversity/observed_hfd-ms_hfd-ee.svg",
width = 4,
height = 4)
print(observed_otus_boxplot)
dev.off()
# Change name of groups
filt_alpha_data$Grupo_Experimental <- recode_factor(filt_alpha_data$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AE = "HFD_EE")
# Input table
alpha_data <- read.table(file = "02_alpha_diversity/alpha_diversity_e24251_r10000.txt",
header = TRUE,
sep = "\t")
# Filter groups HFD_MS vs HFD_EE
filt_alpha_data <- alpha_data %>% filter(grepl('DAG',
Grupo_Experimental))
filt_alpha_data <- filt_alpha_data %>% filter(!grepl('_AN',
Grupo_Experimental))
# Change name of groups
filt_alpha_data$Grupo_Experimental <- recode_factor(filt_alpha_data$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AE = "HFD_EE")
filt_alpha_data <- filt_alpha_data %>% rename(group = "Grupo_Experimental")
# Define colors and shapes
colors <- c("#FB0207", # red
"#000000") # black
# P-value comparisons
p_value <- list(c("HFD_MS",
"HFD_EE"))
# Observed otus boxplot
observed_otus_boxplot <- ggplot(filt_alpha_data,
aes(x = group,
y = Observed.OTUs)) +
geom_boxplot(aes(color = group),
outlier.shape = NA) +
geom_point(aes(color = group),
size = 2,
shape = 21,
position = position_jitterdodge()) +
theme_test(base_size = 8,
base_family = "Arial") +
labs(x = "",
y = "Observed OTUs") +
scale_color_manual(values = colors) +
stat_compare_means(comparisons = p_value,
method = "wilcox.test") +
theme(legend.position = "none")
# Creation of .svg
ggsave("02_alpha_diversity/observed_hfd-ms_hfd-ee.svg",
width = 4,
height = 4)
print(observed_otus_boxplot)
dev.off()
observed_otus_boxplot
# Shannon boxplot
shannon_boxplot <- ggplot(filt_alpha_data,
aes(x = group,
y = Shannon.Index)) +
geom_boxplot(aes(color = group),
outlier.shape = NA) +
geom_point(aes(color = group),
size = 2,
shape = 21,
position = position_jitterdodge()) +
theme_test(base_size = 8,
base_family = "Arial") +
labs(x = "",
y = "Shannon Index") +
scale_color_manual(values = colors) +
stat_compare_means(comparisons = p_value,
method = "wilcox.test") +
theme(legend.position = "none")
# Creation of .svg
ggsave("02_alpha_diversity/shannon_hfd-ms_hfd-ee.svg",
width = 4,
height = 4)
#print(shannon_boxplot)
dev.off()
# Input table
alpha_data <- read.table(file = "02_alpha_diversity/alpha_diversity_e24251_r10000.txt",
header = TRUE,
sep = "\t")
# Filter groups HFD_MS vs HFD_NE
filt_alpha_data <- alpha_data %>% filter(grepl('DAG',
Grupo_Experimental))
filt_alpha_data <- filt_alpha_data %>% filter(!grepl('_AE',
Grupo_Experimental))
# Change name of groups
filt_alpha_data$Grupo_Experimental <- recode_factor(filt_alpha_data$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AN = "HFD_NE")
filt_alpha_data <- filt_alpha_data %>% rename(group = "Grupo_Experimental")
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/01_nd_vs_hfd/unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
View(metadata)
metadata <- metadata %>% filter(grepl("D", Grupo_Experimental)) %>% filter(!grepl("_", Grupo_Experimental))
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/04_dag-sm_vs_dag-an/unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
View(beta_data)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DGA", Grupo_Experimental)) %>% filter(!grepl("AE", Grupo_Experimental))
metadata <- metadata %>% filter(grepl("DGA", Grupo_Experimental)) #%>% filter(!grepl("AE", Grupo_Experimental))
metadata <- metadata %>% filter(grepl("DGA", Description)) %>% filter(!grepl("AE", Description))
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DGA", Description)) %>% filter(!grepl("AE", Description))
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DGA", Description)) #%>% filter(!grepl("AE", Description))
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/04_dag-sm_vs_dag-an/unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DGA", Grupo_Experimental)) #%>% filter(!grepl("AE", Grupo_Experimental))
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>% filter(!grepl("AE", Grupo_Experimental))
View(beta_data)
# Change the name of groups
metadata$Grupo_Experimental <- recode_factor(metadata$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AN = "HFD_NE")
metadata <- metadata %>% mutate(Grupo_Experimental = factor(Grupo_Experimental,
levels=c(
"HFD_MS",
"HFD_MS")))
metadata <- metadata %>% mutate(Grupo_Experimental = factor(Grupo_Experimental,
levels=c(
"HFD_MS",
"HFD_NE")))
# Define colors and shapes
colors <- c("#FB0207", # red
"#800000") # brown
shapes <- c(8, # *
3) # +
# PCoA plot
ord <- cmdscale(beta_data,
eig = T,
k=ncol(beta_data)-1)
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (16.55%)",
x = "PC1 (49.09%)",
title = "ANOSIM=0.9630; p-value=0.002") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt <- gg_ordiplot(ord,
groups = metadata$Grupo_Experimental,
conf = 0.95,
spiders = TRUE,
plot = FALSE,
ellipse = FALSE,
pt.size = 1)
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (16.55%)",
x = "PC1 (49.09%)",
title = "ANOSIM=0.9630; p-value=0.002") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/04_dag-sm_vs_dag-an/unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>%
filter(!grepl("AE", Grupo_Experimental))
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/04_dag-sm_vs_dag-an/unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>%
filter(!grepl("AE", Grupo_Experimental))
# Change the name of groups
metadata$Grupo_Experimental <- recode_factor(metadata$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AN = "HFD_NE")
metadata <- metadata %>% mutate(Grupo_Experimental = factor(Grupo_Experimental,
levels=c(
"HFD_MS",
"HFD_NE")))
# Define colors and shapes
colors <- c("#FB0207", # red
"#800000") # brown
shapes <- c(8, # *
3) # +
# PCoA plot
ord <- cmdscale(beta_data,
eig = T,
k=ncol(beta_data)-1)
plt <- gg_ordiplot(ord,
groups = metadata$Grupo_Experimental,
conf = 0.95,
spiders = TRUE,
plot = FALSE,
ellipse = FALSE,
pt.size = 1)
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (16.55%)",
x = "PC1 (49.09%)",
title = "ANOSIM=0.9630; p-value=0.002") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (13.58%)",
x = "PC1 (30.21%)",
title = "ANOSIM=0.9630; p-value=0.002") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt
plt <- gg_ordiplot(ord,
groups = metadata$Grupo_Experimental,
conf = 0.95,
spiders = TRUE,
plot = FALSE,
ellipse = FALSE,
pt.size = 1)
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (13.58%)",
x = "PC1 (30.21%)",
title = "ANOSIM=0.9630; p-value=0.002") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt
plt <- gg_ordiplot(ord,
groups = metadata$Grupo_Experimental,
conf = 0.95,
spiders = TRUE,
plot = FALSE,
ellipse = FALSE,
pt.size = 1)
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (13.58%)",
x = "PC1 (30.21%)",
title = "ANOSIM=0.4926; p-value=0.009") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt
# Creation of .svg
ggsave("03_beta_diversity/04_dag-sm_vs_dag-an/unweighted_unifrac_dag-sm_vs_dag-an.svg",
width = 4.5,
height = 4)
print(plt)
dev.off()
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/05_dag-sm_vs_dag-ae//unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>%
filter(!grepl("NE", Grupo_Experimental))
View(metadata)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>%
filter(!grepl("AN", Grupo_Experimental))
# Input table and metadata
beta_data <- read.table(file = "03_beta_diversity/05_dag-sm_vs_dag-ae//unweighted_unifrac_dm.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>%
filter(!grepl("AN", Grupo_Experimental))
# Change the name of groups
metadata$Grupo_Experimental <- recode_factor(metadata$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AN = "HFD_EE")
metadata <- metadata %>% mutate(Grupo_Experimental = factor(Grupo_Experimental,
levels=c(
"HFD_MS",
"HFD_EE")))
# Define colors and shapes
colors <- c("#FB0207", # red
"#000000") # black
shapes <- c(8, # *
3) # +
# PCoA plot
ord <- cmdscale(beta_data,
eig = T,
k=ncol(beta_data)-1)
plt <- gg_ordiplot(ord,
groups = metadata$Grupo_Experimental,
conf = 0.95,
spiders = TRUE,
plot = FALSE,
ellipse = FALSE,
pt.size = 1)
# Change the name of groups
metadata$Grupo_Experimental <- recode_factor(metadata$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AE = "HFD_EE")
metadata <- metadata %>% mutate(Grupo_Experimental = factor(Grupo_Experimental,
levels=c(
"HFD_MS",
"HFD_EE")))
metadata <- read.table(file = "metadata_allsamples.txt",
sep="\t",
header=T,
row.names=1,
check.names=F)
metadata <- metadata %>% filter(grepl("DAG", Grupo_Experimental)) %>%
filter(!grepl("AN", Grupo_Experimental))
# Change the name of groups
metadata$Grupo_Experimental <- recode_factor(metadata$Grupo_Experimental,
DAG = "HFD_MS",
DAG_AE = "HFD_EE")
metadata <- metadata %>% mutate(Grupo_Experimental = factor(Grupo_Experimental,
levels=c(
"HFD_MS",
"HFD_EE")))
# Define colors and shapes
colors <- c("#FB0207", # red
"#000000") # black
shapes <- c(8, # *
3) # +
# PCoA plot
ord <- cmdscale(beta_data,
eig = T,
k=ncol(beta_data)-1)
plt <- gg_ordiplot(ord,
groups = metadata$Grupo_Experimental,
conf = 0.95,
spiders = TRUE,
plot = FALSE,
ellipse = FALSE,
pt.size = 1)
plt <- plt$plot +
geom_point(data = plt$df_ord,
aes(x = x, y = y, color = Group, shape = Group),
size = 2) +
scale_color_manual(values = colors) +
scale_shape_manual(values = shapes) +
labs(y = "PC2 (16.14%)",
x = "PC1 (22.51%)",
title = "ANOSIM=0.3204; p-value=0.017") +
geom_hline(yintercept=0,
color = "gray") +
geom_vline(xintercept=0,
color = "gray") +
theme_test(base_size = 8,
base_family = "Arial") +
theme(legend.title = element_blank(),
legend.position = "right",
legend.background = element_blank(),
plot.title = element_text(hjust = 0.5))
plt
# Creation of .svg
ggsave("03_beta_diversity/05_dag-sm_vs_dag-ae/unweighted_unifrac_dag-sm_vs_dag-ae.svg",
width = 4.5,
height = 4)
print(plt)
dev.off()
